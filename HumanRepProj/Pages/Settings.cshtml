@page
@model SettingsModel
@{
    ViewData["Title"] = "Settings";
    Layout = "_Layout";
}

@section Styles {
    <style>
        .settings-header {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        .profile-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #0d6efd;
        }

        .form-section label {
            font-weight: 500;
        }

        .form-section input,
        .form-section textarea,
        .form-section select {
            font-size: 0.875rem;
            padding: 0.5rem;
        }

        .nav-pills .nav-link.active {
            background-color: #0d6efd;
        }
    </style>
}

<div class="row">
    <div class="col-md-3">
        <div class="card sticky-top">
            <div class="card-header bg-white">
                <h5 class="mb-0">Settings Menu</h5>
            </div>
            <div class="card-body p-0">
                <ul class="nav flex-column nav-pills">
                    <li class="nav-item">
                        <a class="nav-link active" data-bs-toggle="pill" href="#profile-tab">
                            <i class="bi bi-person me-2"></i> Profile
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-bs-toggle="pill" href="#otp-tab">
                            <i class="bi bi-shield-lock me-2"></i> OTP
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-bs-toggle="pill" href="#password-tab">
                            <i class="bi bi-key me-2"></i> Passwords & Security
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-bs-toggle="pill" href="#preferences-tab">
                            <i class="bi bi-gear me-2"></i> Preferences
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <div class="col-md-9">
        <div class="tab-content">
            <!-- Profile Section -->
            <div class="tab-pane fade show active" id="profile-tab">
                <div class="card mb-4">
                    <div class="card-header bg-white">
                        <h5 class="mb-0">Profile Information</h5>
                    </div>
                    <div class="card-body form-section">
                        <form>
                            <div class="row mb-3">
                                <div class="col-md-4 text-center">
                                    <img src="images/lebronjamespic.png" alt="Profile Picture" class="profile-avatar mb-3">
                                    <div class="d-grid gap-2">
                                        <button type="button" class="btn btn-outline-primary btn-sm">Upload New</button>
                                        <button type="button" class="btn btn-outline-danger btn-sm">Remove</button>
                                    </div>
                                </div>
                                <div class="col-md-8 row g-3">
                                    <div class="col-md-6">
                                        <label for="firstName">First Name</label>
                                        <input type="text" class="form-control" id="firstName" value="Lebron">
                                    </div>
                                    <div class="col-md-6">
                                        <label for="lastName">Last Name</label>
                                        <input type="text" class="form-control" id="lastName" value="James">
                                    </div>
                                    <div class="col-md-6">
                                        <label for="email">Email</label>
                                        <input type="email" class="form-control" id="email" value="lebron.james@company.com">
                                    </div>
                                    <div class="col-md-6">
                                        <label for="phone">Phone</label>
                                        <input type="tel" class="form-control" id="phone" value="+1 (555) 123-4567">
                                    </div>
                                    <div class="col-12">
                                        <label for="bio">Bio</label>
                                        <textarea class="form-control" id="bio" rows="3">HR Manager with 5+ years of experience.</textarea>
                                    </div>
                                </div>
                            </div>
                            <div class="text-end">
                                <button type="submit" class="btn btn-primary">Save Changes</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- OTP Section -->
            <div class="tab-pane fade" id="otp-tab">
                <div class="card mb-4">
                    <div class="card-header bg-white">
                        <h5 class="mb-0">OTP Settings</h5>
                    </div>
                    <div class="card-body form-section">
                        <form>
                            <div class="mb-3">
                                <label for="otpStatus">Enable OTP</label>
                                <select class="form-select" id="otpStatus">
                                    <option value="enabled">Enabled</option>
                                    <option value="disabled" selected>Disabled</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="otpPhone">Phone Number for OTP</label>
                                <input type="tel" class="form-control" id="otpPhone" placeholder="+1 (555) 123-4567">
                            </div>
                            <div class="text-end">
                                <button type="submit" class="btn btn-primary">Save Changes</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Password Section -->
            <div class="tab-pane fade" id="password-tab">
                <div class="card mb-4">
                    <div class="card-header bg-white">
                        <h5 class="mb-0">Passwords & Security</h5>
                    </div>
                    <div class="card-body form-section">
                        <form>
                            <div class="row g-3">
                                <!-- Current Password -->
                                <div class="col-md-6">
                                    <label for="currentPassword">Current Password</label>
                                    <input type="password" class="form-control" id="currentPassword">
                                </div>

                                <!-- New Password -->
                                <div class="col-md-6">
                                    <label for="newPassword">New Password</label>
                                    <input type="password" class="form-control" id="newPassword">
                                </div>

                                <!-- Confirm Password -->
                                <div class="col-md-6">
                                    <label for="confirmPassword">Retype New Password</label>
                                    <input type="password" class="form-control" id="confirmPassword">
                                </div>

                                <!-- Password Policy -->
                                <div class="col-md-6">
                                    <label for="passwordPolicy">Password Policy</label>
                                    <select id="passwordPolicy" class="form-select">
                                        <option>Minimum 8 characters</option>
                                        <option selected>Min 8, Uppercase + Number</option>
                                        <option>Min 10, Uppercase + Number + Symbol</option>
                                    </select>
                                </div>

                                <!-- New Email -->
                                <div class="col-md-6">
                                    <label for="newEmail">New Email</label>
                                    <input type="email" class="form-control" id="newEmail" placeholder="Enter new email">
                                </div>

                                <!-- Send Confirmation -->
                                <div class="col-md-6">
                                    <label class="invisible d-block">Send Code</label>
                                    <button type="button" class="btn btn-outline-primary w-100">Send Confirmation Code</button>
                                </div>

                                <!-- Code Entry -->
                                <div class="col-md-6">
                                    <label for="confirmationCode">Confirmation Code</label>
                                    <input type="text" class="form-control" id="confirmationCode" placeholder="Enter code">
                                </div>
                            </div>

                            <div class="text-end mt-4">
                                <button type="submit" class="btn btn-primary">Update Security Settings</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="tab-pane fade" id="preferences-tab">
                <div class="card mb-4">
                    <div class="card-header bg-white">
                        <h5 class="mb-0">Preferences</h5>
                    </div>
                    <div class="card-body form-section">
                        <form>
                            <div class="row g-4">
                                <div class="col-md-6">
                                    <label for="language" class="form-label">Language</label>
                                    <select class="form-select" id="language" name="Language">
                                        <option>English</option>
                                        <option>Spanish</option>
                                        <option>French</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label for="localization" class="form-label">Localization</label>
                                    <select class="form-select" id="localization">
                                        <option selected>US</option>
                                        <option>EU</option>
                                        <option>Asia</option>
                                    </select>
                                </div>

                                <div class="col-md-6 d-flex align-items-center">
                                    <label class="form-label me-3">Email Notifications</label>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="emailNotifications" name="EmailNotifications">
                                    </div>
                                </div>
                                <div class="col-md-6 d-flex align-items-center">
                                    <label class="form-label me-3">SMS Notifications</label>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="smsNotifications" name="SmsNotifications">
                                    </div>
                                </div>

                                <div class="col-md-6">
                                    <label for="notificationFrequency" class="form-label">Notification Frequency</label>
                                    <select class="form-select" id="notificationFrequency" name="NotificationFrequency">
                                        <option value="disable">Disable</option>
                                        <option value="1">Every 1 hour</option>
                                        <option value="3">Every 3 hours</option>
                                        <option value="6">Every 6 hours</option>
                                        <option value="12">Every 12 hours</option>
                                        <option value="24">Every 24 hours</option>
                                    </select>
                                </div>

                                <div class="col-md-6">
                                    <label for="currency" class="form-label">Currency</label>
                                    <select class="form-select" id="currency" name="Currency">
                                        <option value="PHP">PHP - Philippine Peso</option>
                                        <option value="USD">USD - US Dollar</option>
                                        <option value="EUR">EUR - Euro</option>
                                        <option value="JPY">JPY - Japanese Yen</option>
                                    </select>
                                </div>

                                <div class="col-md-6">
                                    <label for="timezone" class="form-label">Timezone</label>
                                    <select class="form-select" id="timezone" name="Timezone">
                                        <option value="Asia/Manila">Asia/Manila (Philippines)</option>
                                        <option value="America/New_York">America/New_York</option>
                                        <option value="Europe/London">Europe/London</option>
                                        <option value="Asia/Tokyo">Asia/Tokyo</option>
                                    </select>
                                </div>

                                <div class="col-md-6">
                                    <label for="dateFormat" class="form-label">Date Format</label>
                                    <select class="form-select" id="dateFormat" name="DateFormat">
                                        <option value="MM/DD/YYYY">MM/DD/YYYY</option>
                                        <option value="DD/MM/YYYY">DD/MM/YYYY</option>
                                        <option value="YYYY-MM-DD">YYYY-MM-DD</option>
                                    </select>
                                </div>

                                <div class="col-md-6">
                                    <label for="timeFormat" class="form-label">Time Format</label>
                                    <select class="form-select" id="timeFormat" name="TimeFormat">
                                        <option value="h:mm A">12-Hour (e.g. 3:45 PM)</option>
                                        <option value="HH:mm">24-Hour (e.g. 15:45)</option>
                                    </select>
                                </div>
                            </div>
                            <div class="text-end mt-4">
                                <button type="submit" class="btn btn-primary">Save Preferences</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            
            @section Scripts {
                <script>
                        document.addEventListener("DOMContentLoaded", () => {
                        const detectedTz = Intl.DateTimeFormat().resolvedOptions().timeZone;
                        const tzSelect = document.getElementById("timezone");
                        if (tzSelect) {
                            for (let opt of tzSelect.options) {
                                if (opt.value === detectedTz) {
                                    opt.selected = true;
                                    break;
                                }
                            }
                        }

                        const currencyMap = {
                            "en-PH": "PHP",
                            "fil-PH": "PHP",
                            "en-US": "USD",
                            "en-GB": "GBP",
                            "ja-JP": "JPY",
                            "de-DE": "EUR"
                        };
                        const userLang = navigator.language || navigator.userLanguage;
                        const currency = currencyMap[userLang] || "PHP";
                        const currencySelect = document.getElementById("currency");
                        if (currencySelect) {
                            for (let opt of currencySelect.options) {
                                if (opt.value === currency) {
                                    opt.selected = true;
                                    break;
                                }
                            }
                        }
                    });
                        const userLocale = navigator.language;
                        const defaultCurrency = localeCurrencyMap[userLocale] || "USD";

                        if (currencySelect) {
                            for (let option of currencySelect.options) {
                                if (option.value === defaultCurrency) {
                                    option.selected = true;
                                    break;
                                }
                            }
                        }
                    });
                                     window.addEventListener('DOMContentLoaded', () => {
                        const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
                        const tzSelect = document.getElementById("timezone");
                        if (tzSelect) {
                            for (let option of tzSelect.options) {
                                if (option.value === timezone) {
                                    option.selected = true;
                                    break;
                                }
                            }
                        }
                    });
                                     window.addEventListener('DOMContentLoaded', () => {
                        const currencyMap = {
                            'en-PH': 'PHP',
                            'fil-PH': 'PHP',
                            'en-US': 'USD',
                            'en-GB': 'GBP',
                            'ja-JP': 'JPY',
                            'de-DE': 'EUR'
                            // ➕ Add more mappings as needed
                        };

                        const userLang = navigator.language || navigator.userLanguage;
                        const detectedCurrency = currencyMap[userLang] || 'PHP'; // Default to PHP

                        const currencySelect = document.getElementById("currency");
                        if (currencySelect) {
                            for (let option of currencySelect.options) {
                                if (option.value === detectedCurrency) {
                                    option.selected = true;
                                    break;
                                }
                            }
                        }
                    });
                </script>
            }

